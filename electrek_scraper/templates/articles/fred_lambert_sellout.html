{% extends "public_base.html" %}

{% block title %}The Business of Hate: Anti-Tesla Blog by the Numbers - SparkPubs{% endblock %}

{% block og_title %}The Business of Hate: Anti-Tesla Blog by the Numbers{% endblock %}
{% block og_description %}I analyzed 2,962 articles and 156,636 comments from the leading EV publication. The results reveal a sophisticated business model built on Tesla hate. Data-driven analysis by SparkPubs.{% endblock %}
{% block og_url %}/articles/fred-lambert-sellout{% endblock %}
{% block twitter_title %}The Business of Hate: Anti-Tesla Blog by the Numbers{% endblock %}
{% block twitter_description %}I analyzed 2,962 articles and 156,636 comments from Electrek. The results reveal a business model built on Tesla hate.{% endblock %}

{% block content %}
<article class="medium-article">
    <!-- Article Header -->
    <header>
        <h1>The Business of Hate: Anti-Tesla Blog by the Numbers</h1>
        <div class="article-meta">
            <span class="author">By Lance Jones</span>
            <span class="reading-time">{{ reading_time }}</span>
            {% if show_sparkles %}
            <span class="sparkle-display">✨ {{ sparkle_count }}</span>
            {% endif %}
        </div>
        <p class="article-subtitle">I analyzed 2,962 articles and 156,636 comments from the EV publication, Electrek. The results reveal a not-so-clever business model built on Tesla hate.</p>
    </header>

    <!-- Introduction -->
    <p class="lead">Electrek generates <strong>59.3% of its total engagement</strong> from just <strong>22% of its articles</strong>—all Tesla-focused, predominantly negative content. This isn't bias. It's a business strategy.</p>

    <p>Tesla content produces <strong>5.17 times more engagement</strong> than other EV coverage on the same platform. Every negative headline generates measurable revenue. Every controversy multiplies page views. Every hate comment feeds an algorithmic machine designed to maximize profit through manufactured outrage.</p>

    <p><strong>This isn't about defending Tesla from all criticism</strong>—legitimate concerns about Autopilot safety, workplace issues, and Elon's political controversies deserve coverage. This is about exposing systematic bias that prioritizes engagement over accuracy.</p>

    <p>This isn't journalism. It's a business model built on Tesla controversy.</p>

    <!-- Executive Summary Dashboard -->
    <div class="stats-dashboard">
        <div class="stat-item">
            <span class="stat-number">5.17x</span>
            <span class="stat-label">Engagement Multiplier</span>
        </div>
        <div class="stat-item">
            <span class="stat-number">59.3%</span>
            <span class="stat-label">Of Total Site Traffic</span>
        </div>
        <div class="stat-item">
            <span class="stat-number">3.57x</span>
            <span class="stat-label">Boost for Negative Content</span>
        </div>
        <div class="stat-item">
            <span class="stat-number">128.7%</span>
            <span class="stat-label">Engagement Premium</span>
        </div>
    </div>

    <!-- Section 1 -->
    <h2>From Tesla Superfan to Tesla's Harshest Critic: The $250,000 Transformation</h2>

    <p>Fred Lambert's journey perfectly illustrates how financial incentives corrupt editorial independence. Before becoming Electrek's Editor-in-Chief, Lambert wasn't just a Tesla fan—he was Tesla superfan royalty.</p>

    <p><strong>His credentials were impeccable:</strong></p>
    <ul>
        <li>Moderated r/teslamotors subreddit with 50K+ members</li>
        <li>Reddit username: "FredTesla"</li>
        <li>Promoted Tesla stock on The Motley Fool and investment forums</li>
        <li>Defended Tesla in legal disputes</li>
        <li><strong>Qualified for $250,000 Tesla Roadster</strong> through 69+ referrals</li>
        <li>Accumulated multiple Tesla Powerwalls worth thousands each</li>
    </ul>

    <p><strong>Between 2015-2019, Lambert's Electrek functioned as Tesla's unofficial PR arm.</strong> Articles provided defensive spins on every controversy. Headlines emphasized positive developments. Critical analysis was virtually non-existent.</p>

    <p><strong>Then 2020 happened.</strong> Lambert's coverage shifted toward targeted criticism. Headlines became increasingly negative. The publication evolved from Tesla advocacy to Tesla opposition.</p>

    <p><strong>Recent Lambert headlines reveal the transformation:</strong></p>
    <ul>
        <li>"Tesla might lose its right to sell cars in California amid false advertising lawsuit"</li>
        <li>"Tesla (TSLA) all but admits electric car sales growth is gone"</li>
        <li>"Tesla is the only EV brand with negative perception, and it's getting worse"</li>
    </ul>

    <p><strong>The paradox is obvious:</strong> Lambert criticizes Tesla while remaining financially dependent on Tesla-generated traffic. His editorial stance transformed completely, but his revenue model stayed unchanged.</p>

    <p><strong>What changed wasn't Lambert's financial incentives—it was his discovery that Tesla criticism generates more revenue than Tesla praise.</strong></p>

    <!-- Section 2 -->
    <h2>The Numbers Expose Everything</h2>

    <p>I analyzed <strong>2,962 Electrek articles</strong> published between November 2024 and July 2025. Every headline received sentiment analysis. Every comment was counted across <strong>156,636 total reader responses</strong>.</p>

    <p><strong>The results prove systematic bias:</strong></p>

    <p><strong>Tesla content generates 5.17 times more engagement than other EV coverage.</strong> While Tesla articles represent just 22% of content, they drive 59.3% of all site engagement.</p>

    <p><strong>65.6% of Tesla coverage is negative</strong> compared to just <strong>16.7% for other EV companies.</strong> Same publication. Same time period. Same editorial team.</p>

    <p><strong>Since November 2024, Fred Lambert alone has written 509 Tesla articles with -0.39 average sentiment.</strong> That's more Tesla content than most publications produce across all automotive coverage combined.</p>

    <p><strong>The engagement premium for negative Tesla content is staggering:</strong> Critical Tesla articles generate <strong>128.7% more comments</strong> than positive Tesla coverage.</p>

    <!-- Section 3 -->
    <h2>The Tesla Engagement Monopoly</h2>

    <p>When I break down comment engagement by company, Tesla's dominance becomes absurd.</p>

    <!-- Chart 1: Company Engagement -->
    <div class="chart-container">
        <h4>Average Comments per Article by EV Company</h4>
        <canvas id="companyEngagementChart" height="400"></canvas>
    </div>

    <p><strong>Tesla content: 142.5 comments per article</strong></p>
    <ul>
        <li>Lucid: 52 comments per article</li>
        <li>Volkswagen: 38 comments per article</li>
        <li>Ford: 35 comments per article</li>
        <li>Mercedes: 28 comments per article</li>
        <li>Industry average: 27.6 comments per article</li>
    </ul>

    <p><strong>Tesla content performs 5.17 times better than the industry average.</strong> This isn't marginal—it's systematic audience capture.</p>

    <p><strong>Why would Electrek cover Rivian's latest model when Tesla articles generate 4.75x more engagement?</strong> Why publish BMW analysis when Tesla criticism creates comment sections that drive advertising revenue?</p>

    <p><strong>The business implications are obvious.</strong> Publishers discovered that Tesla equals guaranteed traffic. Traffic equals revenue. Revenue equals editorial assignments focused on Tesla controversy.</p>


    <!-- Chart 2: Editorial Bias -->
    <h2>The Bias Gap: Mathematical Proof of Editorial Prejudice</h2>

    <p><strong>65.6% of Tesla articles are negative vs. 16.7% for other EV companies.</strong> This represents a <strong>48.9% bias gap</strong> that cannot be explained by newsworthiness.</p>

    <div class="chart-container">
        <h4>Editorial Sentiment: Tesla vs Other EV Coverage</h4>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
            <div>
                <h5 style="text-align: center; margin-bottom: 1rem;">Tesla/Elon Coverage</h5>
                <canvas id="teslaDistributionChart" height="300"></canvas>
                <p style="text-align: center; margin-top: 1rem;">
                    <span class="badge badge-negative">{{ business_metrics.tesla_negative_percentage }}% Negative</span>
                </p>
            </div>
            <div>
                <h5 style="text-align: center; margin-bottom: 1rem;">Other EV Coverage</h5>
                <canvas id="nonTeslaDistributionChart" height="300"></canvas>
                <p style="text-align: center; margin-top: 1rem;">
                    <span class="badge badge-positive">{{ business_metrics.non_tesla_negative_percentage }}% Negative</span>
                </p>
            </div>
        </div>
    </div>

    <p><strong>Let's test the obvious defenses:</strong></p>

    <p><strong>Maybe Tesla performed worse than competitors?</strong> Tesla certainly faced challenges during this period—demand softening, political backlash over Elon's DOGE involvement, and increased competition. Meanwhile, traditional automakers struggled with EV transitions, supply chain disruptions, and declining profitability.</p>

    <p><strong>Maybe Tesla faced unique controversies?</strong> Not really. Ford recalled hundreds of thousands of vehicles. Volkswagen dealt with emissions scandal fallout. GM faced safety investigations. Yet none received comparable negative coverage frequency.</p>

    <p><strong>Maybe Musk's behavior warranted scrutiny?</strong> Possibly. But that doesn't explain why Tesla's products, business performance, and technical achievements receive consistently hostile framing.</p>

    <p><strong>The pattern is transparent:</strong></p>
    <ul>
        <li>Tesla delivery numbers "disappoint" despite beating estimates</li>
        <li>Cybertruck faces "production hell" during normal manufacturing ramp</li>
        <li>Tesla price cuts become "desperation moves" while competitor incentives are "strategic pricing"</li>
    </ul>

    <p><strong>Same events, different framing. Same standards, different applications.</strong></p>

    <!-- Chart 3: Sentiment Correlation -->
    <h2>The Hate-Engagement Correlation: Proof That Controversy Pays</h2>

    <p>I analyzed the relationship between article sentiment and reader engagement across thousands of headlines.</p>

    <div class="chart-container">
        <h4>Sentiment vs Engagement Correlation (r = {{ "%.2f"|format(correlation) }})</h4>
        <canvas id="sentimentCorrelationChart" height="500"></canvas>
    </div>

    <p><strong>Correlation coefficient: -0.46</strong></p>

    <p><strong>Translation: The more negative the headline, the more comments it generates.</strong> This isn't coincidence—it's calculated exploitation of reader psychology for profit.</p>

    <p>Articles with extremely negative sentiment (-0.8 to -0.9) consistently generate 500-800+ comments. Positive sentiment articles rarely exceed 200-300 comments.</p>

    <p><strong>The editorial calculation is simple:</strong> Write balanced Tesla analysis and generate 150 comments, or write a Tesla "crisis" piece and generate 600 comments.</p>

    <p><strong>Both Tesla supporters and critics generate engagement that transforms into advertising revenue.</strong> Electrek profits from tribal warfare by deliberately feeding controversy that keeps both sides emotionally invested.</p>

    <!-- Chart 4: Author Specialization -->
    <h2>Editorial Specialization: The Tesla Controversy Assembly Line</h2>

    <p>The bias isn't random—it's deliberate specialization. <strong>Fred Lambert has become Electrek's dedicated Tesla controversy specialist</strong>. This isn't a reporter who occasionally covers Tesla—this is concentrated effort to generate Tesla criticism content.</p>

    <div class="chart-container">
        <h4>Author Tesla Coverage: Article Count vs Average Sentiment</h4>
        <canvas id="authorSpecializationChart" height="400"></canvas>
    </div>

    <p><strong>Since November 2024, Lambert: 509 Tesla articles, -0.39 average sentiment</strong></p>
    <p>Jo Borrás: 53 Tesla articles, -0.29 average sentiment</p>
    <p>Jameson Dow: 50 Tesla articles, -0.4 average sentiment</p>

    <p>Meanwhile:</p>
    <p>Michelle Lewis: 13 Tesla articles, +0.27 average sentiment</p>
    <p>Peter Johnson: 12 Tesla articles, +0.57 average sentiment</p>

    <p><strong>The pattern is systematic, not organic.</strong> Certain authors consistently receive Tesla assignments with predictably negative outcomes. Others focus on different companies with markedly different editorial approaches.</p>

    <p><strong>Lambert has essentially become a Tesla controversy assembly line</strong>—producing targeted criticism content designed to maximize engagement through manufactured outrage.</p>

    <h2>The Greatest Hits: When Headlines Become Weapons</h2>

    <p><strong>Tesla content dominates Electrek's top 25 most-engaging articles.</strong> Only one non-Tesla article appears in the top 25.</p>

    <!-- Top Articles Table -->
    <div class="data-table">
        <table>
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>Headline</th>
                    <th>Comments</th>
                    <th>Sentiment</th>
                </tr>
            </thead>
            <tbody>
                {% for article in top_articles[:25] %}
                <tr>
                    <td><strong>{{ loop.index }}</strong></td>
                    <td class="headline-text">
                        {{ article.title }}
                    </td>
                    <td><strong>{{ article.comment_count }}</strong></td>
                    <td>
                        <span class="badge {% if article.sentiment_score < -0.1 %}badge-negative{% elif article.sentiment_score > 0.1 %}badge-positive{% else %}badge-neutral{% endif %}">
                            {{ article.sentiment_score|round(2) }}
                        </span>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <p><strong>The formula is consistent:</strong></p>

    <p><strong>#1: "Company returns entire Tesla vehicle fleet because of Elon Musk"</strong></p>
    <p><em>856 comments, -0.8 sentiment</em></p>

    <p><strong>#2: "Tesla is done in Germany: 94% say they won't buy a Tesla car"</strong></p>
    <p><em>730 comments, -0.8 sentiment</em></p>

    <p><strong>#3: "Elon Musk loses his mind over Tesla protests, claims paid protestors with dumb 'proof'"</strong></p>
    <p><em>703 comments, -0.9 sentiment</em></p>

    <p><strong>Every headline follows the same formula:</strong> Tesla crisis + Musk controversy + definitive failure language + emotional triggers.</p>

    <p><strong>Compare the language:</strong></p>
    <ul>
        <li><strong>Tesla</strong>: "loses his mind," "done," "can't sell," "crashing," "confirms failure"</li>
        <li><strong>Other EVs</strong>: "strategic repositioning," "proactive safety measures," "manufacturing optimization"</li>
    </ul>

    <p><strong>Tesla's challenges become existential crises. Competitors' identical problems become strategic decisions.</strong></p>

    <!-- Business Model Section -->
    <h2>The Revenue Engine: How Tesla Hate Becomes Cash</h2>

    <div style="text-align: center; margin: 2rem 0;">
        <img src="{{ url_for('static', filename='img/whack-a-musk.png') }}" alt="Whack-a-Musk arcade game generating ad revenue" style="max-width: 100%; height: auto; border-radius: 8px;">
    </div>

    <p><strong>Electrek operates automated affiliate marketing across 75-100 million monthly impressions.</strong> Every Tesla article becomes a revenue opportunity through strategic link placement.</p>

    <p><strong>Google AdSense provides primary revenue.</strong> Higher engagement means more page views. More comments mean longer session duration. <strong>Tesla controversy consistently outperforms other EV coverage across all advertising metrics.</strong></p>

    <p><strong>Traffic data proves Tesla dependency:</strong> "Tesla" and "TSLA" rank among Electrek's top 5 organic keywords. Tesla content drives discovery more than any other automotive coverage.</p>

    <p><strong>Audience demographics reveal the strategy:</strong> 77.3% male readers aged 45-54—precisely Tesla's core customer and investor demographic. <strong>Electrek captured Tesla's audience and monetized coordinated criticism of Tesla.</strong></p>

    <p><strong>The site's 70-72% bounce rate confirms Tesla dependency.</strong> Readers arrive for Tesla content and leave immediately without browsing other EV coverage.</p>

    <p><strong>The business model is self-sustaining:</strong></p>
    <ol>
        <li>Negative Tesla content generates higher engagement</li>
        <li>Higher engagement produces more advertising revenue</li>
        <li>More revenue incentivizes additional Tesla controversy</li>
        <li>Tesla dependency makes Electrek financially reliant on Tesla engagement</li>
    </ol>

    <p><strong>The paradox is complete:</strong> Electrek profits more from Tesla criticism than Tesla praise while remaining fundamentally dependent on Tesla for business sustainability.</p>

    <!-- The $250,000 Question Section -->
    <h2>The $250,000 Question</h2>

    <p><strong>Fred Lambert qualified for a quarter-million-dollar Tesla Roadster through referrals during his superfan years, then transformed into Tesla's harshest critic.</strong> He's still waiting for the car while writing 509 negative Tesla articles since November 2024—all while maintaining financial dependency on Tesla traffic.</p>

    <p><strong>The transformation coincided perfectly with discovering that Tesla controversy generates higher revenue than Tesla advocacy.</strong> Lambert's editorial evolution aligns precisely with algorithmic optimization rather than genuine conviction.</p>

    <p><strong>Lambert positions constant criticism as "tough love":</strong> "While this saddens me, as it will result in fewer EVs on the road, it might be the wake up call that Tesla needs."</p>

    <p><strong>But the data reveals a different story.</strong> Lambert's criticism directly correlates with engagement metrics and advertising revenue. Tesla hate became more profitable than Tesla love.</p>

    <p><strong>The most telling detail?</strong> Despite years of increasingly critical coverage, Lambert continues earning revenue through Tesla-focused traffic, Tesla-related affiliate marketing, and Tesla controversy engagement that far exceeds other EV content performance.</p>

    <p><strong>He's monetized Tesla criticism while remaining dependent on Tesla for business success.</strong></p>

    <!-- Smoking Gun Evidence Section -->
    <h2>The Smoking Gun Evidence</h2>

    <p><strong>This analysis provides mathematical proof of what Tesla supporters suspected:</strong></p>

    <ul>
        <li><strong>5.17x engagement multiplier</strong> for Tesla content proves systematic audience capture</li>
        <li><strong>48.9% bias gap</strong> demonstrates mathematically certain editorial prejudice</li>
        <li><strong>509 Tesla articles since November 2024</strong> by one author reveals deliberate controversy specialization</li>
        <li><strong>-0.46 correlation</strong> between negative sentiment and engagement proves criticism drives revenue</li>
    </ul>

    <p><strong>Fred Lambert's financial incentives never changed—only his editorial strategy.</strong> Tesla referrals, affiliate revenue, and traffic dependency remained constant while coverage shifted from advocacy to systematic opposition.</p>

    <p><strong>Electrek discovered that Tesla hate generates more revenue than Tesla love</strong> while maintaining business dependency on Tesla for traffic and engagement.</p>

    <!-- Conclusion -->
    <h2>The Next Time You See an Electrek Tesla Headline...</h2>

    <p><em>Ask yourself: Is this news about Tesla, or is this Fred Lambert's mortgage payment?</em></p>

    <p><strong>Tesla certainly faces legitimate scrutiny</strong>—Autopilot safety concerns, workplace allegations, Elon's controversial political involvement, and volatile pricing strategies all warrant coverage. But the documented bias goes far beyond proportional criticism.</p>

    <p><strong>The numbers don't lie</strong>:</p>
    <ul>
        <li>Lambert earned a $250,000 Tesla Roadster as a superfan, then wrote 509 negative Tesla articles since November 2024</li>
        <li>Tesla criticism generates 128.7% more engagement than balanced coverage</li>
        <li>Electrek depends on Tesla for 59.3% of site engagement despite negative coverage</li>
        <li>Negative sentiment directly correlates (-0.46) with engagement and revenue</li>
    </ul>

    <p><strong>This isn't about journalism or legitimate criticism.</strong> It's about discovering that Tesla controversy pays better than Tesla coverage.</p>

    <p><strong>Fred Lambert transformed from Tesla superfan to Tesla critic not because of editorial conviction, but because Tesla hate became more profitable than Tesla love.</strong></p>

    <p><strong>Every negative Electrek headline represents a financial calculation disguised as journalism.</strong> Every controversy generates measurable revenue. Every inflammatory headline drives traffic that pays Lambert's bills.</p>

    <p><strong>The business model is transparent:</strong> Monetize Tesla criticism while remaining dependent on Tesla for traffic. Profit from controversy while claiming editorial independence. Generate revenue through editorial bias while maintaining the illusion of journalism.</p>

    <p><strong>You now have mathematical proof of what you already suspected.</strong> Electrek's Tesla coverage isn't journalism—it's a business model built on manufactured outrage designed to monetize Tesla fan emotions.</p>

    <p><strong>The numbers don't lie. But apparently, some blogs do.</strong></p>

    <!-- Sparkle Section -->
    <div style="text-align: center; margin: 3rem 0; padding: 2rem; background: #f9f9f9; border-radius: 8px;">
        <div id="sparkle-section">
            <div class="sparkle-count-display">
                <span id="current-sparkle-count">{{ sparkle_count }}</span>
                <span class="sparkle-label">sparkles</span>
            </div>
            <button id="sparkle-btn" class="sparkle-button" onclick="addSparkle()">
                ✨ Give it a sparkle!
            </button>
            <p class="sparkle-help-text">Show your appreciation for this analysis</p>
        </div>
    </div>

    <hr style="margin: 3rem 0; border: none; border-top: 1px solid #e6e6e6;">

    <p style="font-size: 0.9rem; color: #6b6b6b; font-style: italic;">
        <strong>Methodology:</strong> This analysis examined 2,962 articles from Electrek.co published between November 2024 and July 2025. Headlines were classified using LLM-based sentiment analysis and tagged for Tesla/Elon vs. other EV company focus. Comment counts were tracked as the primary engagement metric across 156,636 total comments.
    </p>
</article>
{% endblock %}

{% block scripts %}
{{ super() }}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Highlight Tesla-related words in headlines
    const headlines = document.querySelectorAll('.headline-text');
    headlines.forEach(headline => {
        const text = headline.innerHTML;
        const highlightedText = text.replace(/(tesla|elon|musk)/gi, '<mark style="background-color: #fff3cd; padding: 1px 3px; border-radius: 2px; font-weight: 500;">$1</mark>');
        headline.innerHTML = highlightedText;
    });

    // Initialize charts for the article
    const sentimentData = {{ sentiment_data|tojson }};
    const authorData = {{ author_analysis|tojson }};
    const companyData = {{ company_comparison|tojson }};
    
    // 1. Company Engagement Chart
    const companyCtx = document.getElementById('companyEngagementChart');
    if (companyCtx && companyData) {
        new Chart(companyCtx, {
            type: 'bar',
            data: {
                labels: companyData.map(c => c.company),
                datasets: [{
                    label: 'Average Comments per Article',
                    data: companyData.map(c => c.avg_comments),
                    backgroundColor: companyData.map(c => 
                        c.company === 'Tesla/Elon' ? 'rgba(255, 107, 0, 0.8)' : 'rgba(108, 117, 125, 0.6)'
                    ),
                    borderColor: companyData.map(c => 
                        c.company === 'Tesla/Elon' ? 'rgba(255, 107, 0, 1)' : 'rgba(108, 117, 125, 1)'
                    ),
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Average Comments' }
                    }
                }
            }
        });
    }

    // 2. Sentiment Correlation Chart
    const sentimentCtx = document.getElementById('sentimentCorrelationChart');
    if (sentimentCtx && sentimentData) {
        new Chart(sentimentCtx, {
            type: 'scatter',
            data: {
                datasets: sentimentData.reduce((acc, article) => {
                    const isNegative = article.sentiment_score < -0.1;
                    const color = isNegative ? 'rgba(220, 53, 69, 0.6)' : 'rgba(40, 167, 69, 0.6)';
                    
                    let dataset = acc.find(d => d.label === (isNegative ? 'Negative Headlines' : 'Positive Headlines'));
                    if (!dataset) {
                        dataset = {
                            label: isNegative ? 'Negative Headlines' : 'Positive Headlines',
                            data: [],
                            backgroundColor: color,
                            borderColor: isNegative ? 'rgba(220, 53, 69, 1)' : 'rgba(40, 167, 69, 1)',
                            pointRadius: 4
                        };
                        acc.push(dataset);
                    }
                    
                    dataset.data.push({
                        x: article.sentiment_score,
                        y: article.comment_count,
                        title: article.title
                    });
                    
                    return acc;
                }, [])
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { 
                        title: { display: true, text: 'Sentiment Score' },
                        min: -1, max: 1
                    },
                    y: { 
                        title: { display: true, text: 'Comment Count' },
                        beginAtZero: true
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return [
                                    `Sentiment: ${context.parsed.x.toFixed(2)}`,
                                    `Comments: ${context.parsed.y}`,
                                    `Title: ${context.raw.title.substring(0, 50)}...`
                                ];
                            }
                        }
                    }
                }
            }
        });
    }

    // 3. Author Specialization Chart
    const authorCtx = document.getElementById('authorSpecializationChart');
    if (authorCtx && authorData) {
        new Chart(authorCtx, {
            type: 'scatter',
            data: {
                datasets: [{
                    label: 'Authors',
                    data: authorData.slice(0, 10).map(author => ({
                        x: author.avg_tesla_sentiment || 0,
                        y: author.tesla_articles || 0,
                        author: author.author,
                        tesla_percentage: author.tesla_percentage || 0,
                        total_articles: author.total_articles || 0
                    })),
                    backgroundColor: 'rgba(255, 107, 0, 0.7)',
                    borderColor: 'rgba(255, 107, 0, 1)',
                    pointRadius: author => author.y > 100 ? 12 : 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { 
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const data = context.raw;
                                return [
                                    `Author: ${data.author}`,
                                    `Tesla Articles: ${data.y}`,
                                    `Total Articles: ${data.total_articles}`,
                                    `Tesla Coverage: ${data.tesla_percentage}%`,
                                    `Avg Tesla Sentiment: ${data.x.toFixed(3)}`
                                ];
                            }
                        }
                    }
                },
                scales: {
                    x: { 
                        title: { display: true, text: 'Average Tesla Sentiment' },
                        min: -1, max: 1
                    },
                    y: { 
                        title: { display: true, text: 'Tesla Articles Count' },
                        beginAtZero: true
                    }
                }
            }
        });
    }

    // 4. Sentiment Distribution Pie Charts
    const teslaCtx = document.getElementById('teslaDistributionChart');
    const nonTeslaCtx = document.getElementById('nonTeslaDistributionChart');
    
    if (teslaCtx && nonTeslaCtx && sentimentData) {
        const teslaArticles = sentimentData.filter(a => {
            const title = a.title.toLowerCase();
            return title.includes('tesla') || title.includes('elon') || title.includes('musk');
        });
        const nonTeslaArticles = sentimentData.filter(a => {
            const title = a.title.toLowerCase();
            return !(title.includes('tesla') || title.includes('elon') || title.includes('musk'));
        });
        
        const createPieChart = (ctx, data, title) => {
            const negative = data.filter(a => a.sentiment_score <= -0.1).length;
            const positive = data.filter(a => a.sentiment_score >= 0.1).length;
            const neutral = data.length - negative - positive;
            
            return new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Negative', 'Neutral', 'Positive'],
                    datasets: [{
                        data: [negative, neutral, positive],
                        backgroundColor: [
                            'rgba(220, 53, 69, 0.8)',
                            'rgba(108, 117, 125, 0.8)',
                            'rgba(40, 167, 69, 0.8)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });
        };
        
        createPieChart(teslaCtx, teslaArticles, 'Tesla');
        createPieChart(nonTeslaCtx, nonTeslaArticles, 'Non-Tesla');
    }

});

// Sparkle functionality (global scope)
let hasSparkled = false;

function addSparkle() {
        if (hasSparkled) {
            showMessage('You already sparkled this article today!', 'warning');
            return;
        }
        
        const btn = document.getElementById('sparkle-btn');
        btn.disabled = true;
        btn.innerHTML = '✨ Sparkling...';
        
        fetch(`/api/engagement/{{ article_slug }}/sparkle`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Update count
                document.getElementById('current-sparkle-count').textContent = data.count;
                
                // Update button
                btn.innerHTML = '✨ Sparkled!';
                btn.style.background = '#28a745';
                
                // Mark as sparkled
                hasSparkled = true;
                
                // Show success message
                showMessage('Thank you for the sparkle! ✨', 'success');
                
                // Add sparkle animation
                animateSparkle();
                
            } else {
                // Handle error
                btn.disabled = false;
                btn.innerHTML = '✨ Give it a sparkle!';
                
                if (data.error === 'Already sparkled today') {
                    hasSparkled = true;
                    showMessage('You already sparkled this article today!', 'warning');
                } else {
                    showMessage('Failed to add sparkle. Please try again.', 'error');
                }
            }
        })
        .catch(error => {
            console.error('Error:', error);
            btn.disabled = false;
            btn.innerHTML = '✨ Give it a sparkle!';
            showMessage('Failed to add sparkle. Please try again.', 'error');
        });
}

function showMessage(message, type) {
        // Create message element
        const msgEl = document.createElement('div');
        msgEl.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 4px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            background: ${type === 'success' ? '#28a745' : type === 'warning' ? '#ffc107' : '#dc3545'};
        `;
        msgEl.textContent = message;
        
        document.body.appendChild(msgEl);
        
        // Remove after 3 seconds
        setTimeout(() => {
            document.body.removeChild(msgEl);
        }, 3000);
}

function animateSparkle() {
        const btn = document.getElementById('sparkle-btn');
        btn.style.transform = 'scale(1.1)';
        btn.style.transition = 'transform 0.2s ease';
        
        setTimeout(() => {
            btn.style.transform = 'scale(1)';
        }, 200);
}
</script>

<style>
.sparkle-count-display {
    font-size: 1.5rem;
    margin-bottom: 1rem;
    color: #333;
}

.sparkle-count-display #current-sparkle-count {
    font-weight: bold;
    font-size: 2rem;
    color: #ff6b00;
}

.sparkle-label {
    margin-left: 0.5rem;
    color: #666;
}

.sparkle-button {
    background: #ff6b00;
    color: white;
    border: none;
    padding: 12px 24px;
    font-size: 1.1rem;
    border-radius: 25px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin: 0 0 1rem 0;
    font-weight: 500;
}

.sparkle-button:hover:not(:disabled) {
    background: #e55a00;
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.sparkle-button:disabled {
    opacity: 0.7;
    cursor: not-allowed;
}

.sparkle-help-text {
    color: #666;
    font-size: 0.9rem;
    margin: 0;
}

.sparkle-display {
    color: #ff6b00;
    font-weight: 500;
    margin-left: 1rem;
}

.sparkle-count {
    color: #ff6b00;
    font-weight: 500;
}
</style>
{% endblock %}